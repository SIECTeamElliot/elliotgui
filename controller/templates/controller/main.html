<!DOCTYPE html>

<html>

    <head>
        <meta charset="utf-8" />
        {% load static %}
        <link rel="stylesheet" href="{% static 'controller/main.css' %}" />

        <title>Elliot Control Interface</title>

    </head>
    <body style="height: 1000px;">
		<div id="keys"></div>

		<div id="logs"></div>

		<div id="hidden" style="display: none;"></div>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> 
		<script type='text/javascript' src="{% static 'controller/keys.js' %}"></script>
		<script type="text/javascript" src="{% static 'controller/virtualjoystick.js' %}"></script>
		<script type="text/javascript">
			var joystick = new VirtualJoystick(); 

			function onMove(e) {
				var ver_type; 
				var hor_type; 
				if(joystick.up()) {
					ver_type = 'up'; 
				} else if (joystick.down()) {
					ver_type = 'down'; 
				}
				if(joystick.left()) {
					ver_type = 'left'; 
				} else if (joystick.right()) {
					ver_type = 'right'; 
				}
				$('#hidden').load('event?type=' + ver_type + '&trig=down'); 
				$('#hidden').load('event?type=' + hor_type + '&trig=down'); 
			}

			joystick.addEventListener('touchStart', function(e) {
				alert('lol');
				joystick._container.addEventListener( 'touchmove' , onMove);
				joystick._container.addEventListener( 'mousemove' , onMove); 
			}); 

			joystick.addEventListener('touchEnd', function(e) {
				joystick._container.removeEventListener( 'touchmove' , onMove);
				joystick._container.removeEventListener( 'mousemove' , onMove); 
			}); 
			
		</script>
		<script type="text/javascript"></script>
	</body>
</html>